<div class="container mt-5">
 <div class="row">
  <div class='mx-auto col-lg-10'>
  </div>
 </div>
</div>
<!--商品詳細-->
 <div class="row">
  <div class="col-4 offset-2 text-center mt-4">
   <%= image_tag @item.get_image(400,480), class:"card-img-top" %><br>
  </div>

  <div class="col-3 ml-5">
      <h3><strong><%= @item.name %></strong></h3>
       <%= @item.introduction %>
       <h3><strong><%= @item.tax_include_price.to_s(:delimited) %>円(税込)</strong></h3>
       <% if @item.is_active == false %>
       <%= form_with model: @cart_item, url: cart_items_path, method: :post do |f| %>
        <%= f.hidden_field :item_id, :value => @item.id %>
        <%= f.select :amount, *[1..10], include_blank: "個数選択" %>

   <div class="mt-3" style="padding: 10px; border-top: solid 1px #ccc;">
    <div class="col-12 offset-1 mt-3">
      <%= f.submit "カートに入れる", class: "btn btn-block text-light mt-3", style: "background-color:#d2b48c" %>
       <% end %>

       <% else %>
        <span class="text-danger" ><strong>販売停止中</strong></span>
       <% end %>

   <!--お気に入り-->
   <div class="btn btn-block text-center mt-3" style="background-color:#d2b48c">
    <div class="favorite_btn_<%= @item.id %> favorite-size">
      <%= render "public/favorites/favorite", item: @item %>
     </div>
    </div>
    </div>
   </div>
  </div>
 </div>
 <!--レビュー-->

<%= render "public/item_comments/comment" %>

<div class="comment-container">
  <% @item_comments.each do |c| %>
    <div class="pt-2 px-2" style="background-color: #fffffe; border: 2px solid #272343; border-radius: 2px;">
        <div class="review-rating" data-score="<%= c.rate %>">評価：<%= c.rate %></div>

        <div class="text-left">
            <p>投稿者：<%= c.customer_id %></p>
            <p><%= c.comment %></p>
        </div>

        <div class="text-right">
            <p>
                投稿日：<%= c.created_at.strftime('%Y/%m/%d') %>
            </p>
        </div>
    </div>

    <div class="pb-2"></div>

  <% end %>

<% if customer_signed_in? %>
  <%= form_with(model: [@item, @item_comment], local: true) do |f| %>

    <%= f.text_area :comment, rows:'5', placeholder: "コメント", class: "form-control form-control-sm" %>
    <div id="rating-form">
        <label>評価：</label>
        <%= f.hidden_field :rate, :value => 'score' %>
    </div>

    <%= f.submit "投稿する" %>
  <% end %>
</div>

<script>
    $('#rating-form').raty({
        starOn: "<%= asset_path('star-on.png') %>",
        starOff: "<%= asset_path('star-off.png') %>",
        scoreName: 'comment[rate]'
    });
</script>
<% end %>